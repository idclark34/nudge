{"version":3,"sources":["../../electron/main.ts","../../electron/database.ts","../../electron/windows/mainWindow.ts","../../electron/windows/promptWindow.ts","../../electron/ipc/registerHandlers.ts","../../electron/services/journalService.ts","../../electron/services/projectsService.ts","../../electron/services/promptService.ts","../../electron/services/settingsService.ts","../../electron/services/traitsService.ts","../../electron/services/statsService.ts","../../electron/tray.ts","../../electron/promptScheduler.ts"],"sourcesContent":["import path from \"node:path\";\nimport { app, BrowserWindow, nativeTheme, Tray } from \"electron\";\nimport { getDatabase } from \"./database\";\nimport { createMainWindow } from \"./windows/mainWindow\";\nimport { createPromptWindow } from \"./windows/promptWindow\";\nimport { registerIpcHandlers } from \"./ipc/registerHandlers\";\nimport {\n  getSettings as readSettings,\n  pausePrompts,\n  resumePrompts,\n  updateSettings as writeSettings,\n} from \"./services/settingsService\";\nimport { createQuietQuestionsTray } from \"./tray\";\nimport { PromptScheduler } from \"./promptScheduler\";\n\nlet mainWindow: BrowserWindow | null = null;\nlet promptWindow: BrowserWindow | null = null;\nlet tray: Tray | null = null;\nlet scheduler: PromptScheduler | null = null;\n\nconst getRendererUrl = () => {\n  const devServerUrl = process.env.VITE_DEV_SERVER_URL;\n  if (devServerUrl) {\n    return devServerUrl;\n  }\n\n  return `file://${path.join(__dirname, \"../renderer/index.html\")}`;\n};\n\nconst getPreloadPath = () => path.join(__dirname, \"preload.js\");\n\nconst isPromptWindowOpen = () =>\n  !!promptWindow && !promptWindow.isDestroyed();\n\nconst focusOrRestore = (window: BrowserWindow) => {\n  if (window.isMinimized()) {\n    window.restore();\n  }\n  if (!window.isVisible()) {\n    window.show();\n  }\n  window.focus();\n};\n\nconst openMainWindow = () => {\n  if (!mainWindow || mainWindow.isDestroyed()) {\n    mainWindow = createMainWindow({\n      preloadPath: getPreloadPath(),\n      rendererUrl: getRendererUrl(),\n    });\n\n    mainWindow.on(\"closed\", () => {\n      mainWindow = null;\n    });\n  } else {\n    focusOrRestore(mainWindow);\n  }\n};\n\nconst openPromptWindow = (options?: { quickEntry?: boolean }) => {\n  if (promptWindow && !promptWindow.isDestroyed()) {\n    focusOrRestore(promptWindow);\n    return;\n  }\n\n  promptWindow = createPromptWindow({\n    preloadPath: getPreloadPath(),\n    rendererUrl: getRendererUrl(),\n    quickEntry: options?.quickEntry,\n  });\n\n  promptWindow.on(\"closed\", () => {\n    promptWindow = null;\n  });\n};\n\nconst setupScheduler = () => {\n  scheduler = new PromptScheduler({\n    getSettings: readSettings,\n    isPromptWindowOpen,\n    openPromptWindow: () => openPromptWindow(),\n  });\n  scheduler.start();\n};\n\nconst setupTray = async () => {\n  tray = await createQuietQuestionsTray({\n    getMainWindow: () => mainWindow,\n    openMainWindow,\n    openPromptWindow,\n    pausePrompts: async () => {\n      const settings = pausePrompts();\n      scheduler?.refresh();\n      return settings;\n    },\n    resumePrompts: async () => {\n      const settings = resumePrompts();\n      scheduler?.refresh();\n      return settings;\n    },\n    getSettings: async () => readSettings(),\n    updateSettings: async (patch) => {\n      const updated = writeSettings(patch);\n      scheduler?.refresh();\n      return updated;\n    },\n    refreshScheduler: () => scheduler?.refresh(),\n    quit: () => {\n      scheduler?.stop();\n      app.quit();\n    },\n  });\n};\n\nconst bootstrap = async () => {\n  app.setAppUserModelId(\"com.quietquestions.app\");\n  nativeTheme.themeSource = \"light\";\n\n  getDatabase();\n  openMainWindow();\n\n  registerIpcHandlers({\n    openPromptWindow: (options) => {\n      openPromptWindow(options);\n    },\n    refreshScheduler: () => scheduler?.refresh(),\n    snoozePrompt: (minutes) => scheduler?.snooze(minutes ?? 15),\n  });\n\n  setupScheduler();\n  await setupTray();\n};\n\napp.on(\"ready\", bootstrap);\n\napp.on(\"activate\", () => {\n  if (BrowserWindow.getAllWindows().length === 0) {\n    openMainWindow();\n  }\n});\n\napp.on(\"window-all-closed\", () => {\n  if (process.platform !== \"darwin\") {\n    app.quit();\n  }\n});\n\napp.on(\"before-quit\", () => {\n  scheduler?.stop();\n});\n\n","import fs from \"node:fs\";\nimport path from \"node:path\";\nimport { app } from \"electron\";\nimport Database from \"better-sqlite3\";\nimport type { EntryCategory } from \"../src/types/journal\";\n\nexport interface JournalEntryRecord {\n  id: number;\n  created_at: string;\n  prompt_id: number | null;\n  prompt_text: string | null;\n  category: EntryCategory;\n  project_tag: string | null;\n  trait_tag: string | null;\n  text: string;\n  sentiment: string | null;\n  meta: string | null;\n}\n\nexport interface SettingsRecord {\n  id: number;\n  prompt_interval_minutes: number;\n  quiet_hours_start: string;\n  quiet_hours_end: string;\n  is_paused: number;\n  updated_at: string;\n}\n\nlet db: Database.Database | null = null;\n\nexport const getDatabase = (): Database.Database => {\n  if (db) {\n    return db;\n  }\n\n  const userDataPath = app.getPath(\"userData\");\n  const dbDirectory = path.join(userDataPath, \"storage\");\n  if (!fs.existsSync(dbDirectory)) {\n    fs.mkdirSync(dbDirectory, { recursive: true });\n  }\n\n  const dbPath = path.join(dbDirectory, \"quiet-questions.db\");\n  db = new Database(dbPath);\n\n  db.pragma(\"journal_mode = WAL\");\n  db.pragma(\"foreign_keys = ON\");\n\n  runMigrations(db);\n  seedStaticData(db);\n\n  return db;\n};\n\nconst runMigrations = (database: Database.Database) => {\n  database\n    .prepare(\n      `\n      CREATE TABLE IF NOT EXISTS prompt_categories (\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\n        name TEXT NOT NULL UNIQUE\n      );\n    `,\n    )\n    .run();\n\n  database\n    .prepare(\n      `\n      CREATE TABLE IF NOT EXISTS prompts (\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\n        text TEXT NOT NULL,\n        category_id INTEGER NOT NULL,\n        is_active INTEGER NOT NULL DEFAULT 1,\n        requires_project INTEGER NOT NULL DEFAULT 0,\n        created_at TEXT NOT NULL DEFAULT CURRENT_TIMESTAMP,\n        FOREIGN KEY (category_id) REFERENCES prompt_categories(id)\n      );\n    `,\n    )\n    .run();\n\n  database\n    .prepare(\n      `\n      CREATE TABLE IF NOT EXISTS journal_entries (\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\n        created_at TEXT NOT NULL DEFAULT CURRENT_TIMESTAMP,\n        prompt_id INTEGER,\n        prompt_text TEXT,\n        category TEXT NOT NULL,\n        project_tag TEXT,\n        trait_tag TEXT,\n        text TEXT NOT NULL,\n        sentiment TEXT,\n        meta TEXT,\n        FOREIGN KEY (prompt_id) REFERENCES prompts(id)\n      );\n    `,\n    )\n    .run();\n\n  database\n    .prepare(\n      `\n      CREATE TABLE IF NOT EXISTS projects (\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\n        name TEXT NOT NULL UNIQUE,\n        created_at TEXT NOT NULL DEFAULT CURRENT_TIMESTAMP\n      );\n    `,\n    )\n    .run();\n\n  database\n    .prepare(\n      `\n      CREATE TABLE IF NOT EXISTS traits (\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\n        name TEXT NOT NULL UNIQUE,\n        created_at TEXT NOT NULL DEFAULT CURRENT_TIMESTAMP\n      );\n    `,\n    )\n    .run();\n\n  database\n    .prepare(\n      `\n      CREATE TABLE IF NOT EXISTS settings (\n        id INTEGER PRIMARY KEY CHECK (id = 1),\n        prompt_interval_minutes INTEGER NOT NULL,\n        quiet_hours_start TEXT NOT NULL,\n        quiet_hours_end TEXT NOT NULL,\n        is_paused INTEGER NOT NULL DEFAULT 0,\n        updated_at TEXT NOT NULL\n      );\n    `,\n    )\n    .run();\n};\n\nconst seedStaticData = (database: Database.Database) => {\n  const existingSettings = database\n    .prepare(\"SELECT COUNT(*) as count FROM settings WHERE id = 1;\")\n    .get() as { count: number };\n  if (!existingSettings.count) {\n    database\n      .prepare(\n        `\n        INSERT INTO settings (id, prompt_interval_minutes, quiet_hours_start, quiet_hours_end, is_paused, updated_at)\n        VALUES (1, 90, '22:00', '07:00', 0, CURRENT_TIMESTAMP);\n      `,\n      )\n      .run();\n  }\n\n  const categories: EntryCategory[] = [\n    \"project\",\n    \"emotion\",\n    \"trait\",\n    \"productivity\",\n    \"identity\",\n    \"small_win\",\n    \"behavior\",\n  ];\n\n  const insertCategory = database.prepare(\n    \"INSERT OR IGNORE INTO prompt_categories (name) VALUES (?);\",\n  );\n  categories.forEach((categoryName) => insertCategory.run(categoryName));\n\n  const promptsSeed: Array<{\n    text: string;\n    category: EntryCategory;\n    requiresProject?: boolean;\n  }> = [\n    {\n      text: \"How has the [PROJECT] project been coming today?\",\n      category: \"project\",\n      requiresProject: true,\n    },\n    {\n      text: \"What progress did you make today on [PROJECT]?\",\n      category: \"project\",\n      requiresProject: true,\n    },\n    {\n      text: \"What emotion kept showing up for you today?\",\n      category: \"emotion\",\n    },\n    {\n      text: \"What feeling surprised you today?\",\n      category: \"emotion\",\n    },\n    {\n      text: \"How did you practice resilience today?\",\n      category: \"trait\",\n    },\n    {\n      text: \"Where did you show curiosity today?\",\n      category: \"trait\",\n    },\n    {\n      text: \"What is one meaningful thing you completed recently?\",\n      category: \"productivity\",\n    },\n    {\n      text: \"What small task could you do next to build momentum?\",\n      category: \"productivity\",\n    },\n    {\n      text: \"If your future self saw you right now, what would they say?\",\n      category: \"identity\",\n    },\n    {\n      text: \"What’s one tiny win from today?\",\n      category: \"small_win\",\n    },\n    {\n      text: \"What action are you avoiding that would actually help?\",\n      category: \"behavior\",\n    },\n    {\n      text: \"What's blocking your focus right now?\",\n      category: \"behavior\",\n    },\n  ];\n\n  const insertPrompt = database.prepare(\n    `\n      INSERT OR IGNORE INTO prompts (text, category_id, is_active, requires_project)\n      VALUES (\n        @text,\n        (SELECT id FROM prompt_categories WHERE name = @category),\n        1,\n        @requires_project\n      );\n    `,\n  );\n\n  const existingPrompts = new Set<string>();\n  const promptRows = database\n    .prepare(\"SELECT text FROM prompts;\")\n    .all() as Array<{ text: string }>;\n  promptRows.forEach((row) => existingPrompts.add(row.text));\n\n  promptsSeed.forEach((prompt) => {\n    if (!existingPrompts.has(prompt.text)) {\n      insertPrompt.run({\n        text: prompt.text,\n        category: prompt.category,\n        requires_project: prompt.requiresProject ? 1 : 0,\n      });\n    }\n  });\n};\n\n","import path from \"node:path\";\nimport { BrowserWindow, shell } from \"electron\";\n\ninterface CreateMainWindowOptions {\n  preloadPath: string;\n  rendererUrl: string;\n}\n\nexport const createMainWindow = ({\n  preloadPath,\n  rendererUrl,\n}: CreateMainWindowOptions): BrowserWindow => {\n  const window = new BrowserWindow({\n    width: 1200,\n    height: 780,\n    minWidth: 900,\n    minHeight: 640,\n    title: \"Quiet Questions\",\n    backgroundColor: \"#fdfbf5\",\n    show: false,\n    titleBarStyle: \"hiddenInset\",\n    trafficLightPosition: { x: 14, y: 16 },\n    webPreferences: {\n      preload: preloadPath,\n      nodeIntegration: false,\n      contextIsolation: true,\n      sandbox: false,\n      spellcheck: false,\n    },\n  });\n\n  window.once(\"ready-to-show\", () => {\n    if (!window.isDestroyed()) {\n      window.show();\n    }\n  });\n\n  window.webContents.setWindowOpenHandler(({ url }) => {\n    shell.openExternal(url);\n    return { action: \"deny\" };\n  });\n\n  const targetUrl = rendererUrl.endsWith(\"/\")\n    ? `${rendererUrl}#/`\n    : `${rendererUrl}/#/`;\n  window.loadURL(targetUrl);\n\n  return window;\n};\n\n","import { BrowserWindow } from \"electron\";\n\ninterface CreatePromptWindowOptions {\n  preloadPath: string;\n  rendererUrl: string;\n  quickEntry?: boolean;\n}\n\nexport const createPromptWindow = ({\n  preloadPath,\n  rendererUrl,\n  quickEntry,\n}: CreatePromptWindowOptions): BrowserWindow => {\n  const window = new BrowserWindow({\n    width: 420,\n    height: 360,\n    resizable: false,\n    maximizable: false,\n    minimizable: false,\n    alwaysOnTop: true,\n    show: false,\n    frame: false,\n    title: quickEntry ? \"Quiet Questions — Quick Entry\" : \"Quiet Questions\",\n    backgroundColor: \"#fdfbf5\",\n    webPreferences: {\n      preload: preloadPath,\n      nodeIntegration: false,\n      contextIsolation: true,\n      sandbox: false,\n      spellcheck: true,\n    },\n  });\n\n  window.once(\"ready-to-show\", () => window.show());\n\n  const urlBase = rendererUrl.endsWith(\"/\")\n    ? `${rendererUrl}#/prompt`\n    : `${rendererUrl}/#/prompt`;\n  const url = quickEntry ? `${urlBase}?quick=1` : urlBase;\n\n  window.loadURL(url);\n  return window;\n};\n\n","import { ipcMain } from \"electron\";\nimport type {\n  JournalEntryFilters,\n  JournalEntryInput,\n  JournalEntryPatch,\n} from \"../../src/types/journal\";\nimport type { PromptSelectionContext } from \"../../src/types/prompt\";\nimport type { SettingsPatch } from \"../../src/types/settings\";\nimport {\n  createEntry,\n  deleteEntry,\n  getEntries,\n  updateEntry,\n} from \"../services/journalService\";\nimport {\n  selectPrompt,\n  markPromptHandled,\n} from \"../services/promptService\";\nimport {\n  getSettings,\n  pausePrompts,\n  resumePrompts,\n  updateSettings,\n} from \"../services/settingsService\";\nimport {\n  createProject,\n  deleteProject,\n  listProjects,\n  updateProject,\n} from \"../services/projectsService\";\nimport {\n  createTrait,\n  deleteTrait,\n  listTraits,\n  updateTrait,\n} from \"../services/traitsService\";\nimport { buildInsightsSummary } from \"../services/statsService\";\n\nexport interface IpcHandlerContext {\n  openPromptWindow: (options?: { quickEntry?: boolean }) => void;\n  refreshScheduler: () => void;\n  snoozePrompt: (minutes: number) => void;\n}\n\nexport const registerIpcHandlers = (ctx: IpcHandlerContext) => {\n  ipcMain.handle(\"entries:create\", async (_event, payload: JournalEntryInput) =>\n    createEntry(payload),\n  );\n\n  ipcMain.handle(\"entries:get\", async (_event, filters: JournalEntryFilters) =>\n    getEntries(filters),\n  );\n\n  ipcMain.handle(\n    \"entries:update\",\n    async (_event, id: number, patch: JournalEntryPatch) =>\n      updateEntry(id, patch),\n  );\n\n  ipcMain.handle(\"entries:delete\", async (_event, id: number) => {\n    deleteEntry(id);\n    return true;\n  });\n\n  ipcMain.handle(\n    \"prompts:get\",\n    async (_event, context?: PromptSelectionContext) =>\n      selectPrompt(context ?? undefined),\n  );\n\n  ipcMain.handle(\n    \"prompts:handled\",\n    async (_event, promptId: number, action: \"saved\" | \"skipped\") => {\n      markPromptHandled();\n      return { promptId, action };\n    },\n  );\n\n  ipcMain.handle(\"prompts:quick-entry\", async () => {\n    ctx.openPromptWindow({ quickEntry: true });\n  });\n\n  ipcMain.handle(\"prompts:snooze\", async (_event, minutes: number) => {\n    ctx.snoozePrompt(minutes);\n    return true;\n  });\n\n  ipcMain.handle(\"settings:get\", async () => getSettings());\n\n  ipcMain.handle(\n    \"settings:update\",\n    async (_event, patch: SettingsPatch) => {\n      const updated = updateSettings(patch);\n      ctx.refreshScheduler();\n      return updated;\n    },\n  );\n\n  ipcMain.handle(\"settings:pause\", async () => {\n    const updated = pausePrompts();\n    ctx.refreshScheduler();\n    return updated;\n  });\n  ipcMain.handle(\"settings:resume\", async () => {\n    const updated = resumePrompts();\n    ctx.refreshScheduler();\n    return updated;\n  });\n\n  ipcMain.handle(\"projects:list\", async () => listProjects());\n  ipcMain.handle(\"projects:create\", async (_event, name: string) =>\n    createProject(name),\n  );\n  ipcMain.handle(\n    \"projects:update\",\n    async (_event, id: number, name: string) => updateProject(id, name),\n  );\n  ipcMain.handle(\"projects:delete\", async (_event, id: number) => {\n    deleteProject(id);\n    return true;\n  });\n\n  ipcMain.handle(\"traits:list\", async () => listTraits());\n  ipcMain.handle(\"traits:create\", async (_event, name: string) =>\n    createTrait(name),\n  );\n  ipcMain.handle(\n    \"traits:update\",\n    async (_event, id: number, name: string) => updateTrait(id, name),\n  );\n  ipcMain.handle(\"traits:delete\", async (_event, id: number) => {\n    deleteTrait(id);\n    return true;\n  });\n\n  ipcMain.handle(\"stats:get\", async () => buildInsightsSummary());\n\n  // no-op handler reserved for future needs\n};\n\n","import type Database from \"better-sqlite3\";\nimport dayjs from \"dayjs\";\nimport { getDatabase } from \"../database\";\nimport type {\n  JournalEntry,\n  JournalEntryFilters,\n  JournalEntryInput,\n  JournalEntryPatch,\n} from \"../../src/types/journal\";\n\nconst entryFields = [\n  \"id\",\n  \"created_at\",\n  \"prompt_id\",\n  \"prompt_text\",\n  \"category\",\n  \"project_tag\",\n  \"trait_tag\",\n  \"text\",\n  \"sentiment\",\n  \"meta\",\n] as const;\n\ntype EntryRow = Record<(typeof entryFields)[number], unknown>;\n\nconst mapEntry = (row: EntryRow): JournalEntry => ({\n  id: Number(row.id),\n  createdAt: String(row.created_at),\n  promptId: row.prompt_id !== null ? Number(row.prompt_id) : null,\n  promptText: row.prompt_text !== null ? String(row.prompt_text) : null,\n  category: row.category as JournalEntry[\"category\"],\n  projectTag: row.project_tag !== null ? String(row.project_tag) : null,\n  traitTag: row.trait_tag !== null ? String(row.trait_tag) : null,\n  text: String(row.text ?? \"\"),\n  sentiment: row.sentiment !== null ? String(row.sentiment) : null,\n  meta:\n    typeof row.meta === \"string\" && row.meta.length\n      ? (JSON.parse(String(row.meta)) as Record<string, unknown>)\n      : null,\n});\n\nconst getDb = (): Database.Database => getDatabase();\n\nexport const createEntry = (input: JournalEntryInput): JournalEntry => {\n  const db = getDb();\n  const createdAt = input.createdAt ?? new Date().toISOString();\n  const result = db\n    .prepare(\n      `\n      INSERT INTO journal_entries (\n        created_at,\n        prompt_id,\n        prompt_text,\n        category,\n        project_tag,\n        trait_tag,\n        text,\n        sentiment,\n        meta\n      ) VALUES (\n        @created_at,\n        @prompt_id,\n        @prompt_text,\n        @category,\n        @project_tag,\n        @trait_tag,\n        @text,\n        @sentiment,\n        @meta\n      );\n    `,\n    )\n    .run({\n      created_at: createdAt,\n      prompt_id: input.promptId ?? null,\n      prompt_text: input.promptText ?? null,\n      category: input.category,\n      project_tag: input.projectTag ?? null,\n      trait_tag: input.traitTag ?? null,\n      text: input.text,\n      sentiment: input.sentiment ?? null,\n      meta: input.meta ? JSON.stringify(input.meta) : null,\n    });\n\n  return getEntryById(Number(result.lastInsertRowid));\n};\n\nexport const getEntryById = (id: number): JournalEntry => {\n  const db = getDb();\n  const row = db\n    .prepare(\n      `\n      SELECT ${entryFields.join(\", \")}\n      FROM journal_entries\n      WHERE id = ?;\n    `,\n    )\n    .get(id) as EntryRow | undefined;\n\n  if (!row) {\n    throw new Error(`Entry ${id} not found`);\n  }\n\n  return mapEntry(row);\n};\n\nexport const getEntries = (\n  filters: JournalEntryFilters,\n): { entries: JournalEntry[]; total: number } => {\n  const db = getDb();\n  const where: string[] = [];\n  const params: Record<string, unknown> = {};\n\n  if (filters.fromDate) {\n    where.push(\"datetime(created_at) >= datetime(@fromDate)\");\n    params.fromDate = filters.fromDate;\n  }\n  if (filters.toDate) {\n    where.push(\"datetime(created_at) <= datetime(@toDate)\");\n    params.toDate = filters.toDate;\n  }\n  if (filters.category) {\n    where.push(\"category = @category\");\n    params.category = filters.category;\n  }\n  if (filters.projectTag) {\n    where.push(\"project_tag = @projectTag\");\n    params.projectTag = filters.projectTag;\n  }\n  if (filters.traitTag) {\n    where.push(\"trait_tag = @traitTag\");\n    params.traitTag = filters.traitTag;\n  }\n\n  const whereClause = where.length ? `WHERE ${where.join(\" AND \")}` : \"\";\n  const limit = Number(filters.limit ?? 50);\n  const offset = Number(filters.offset ?? 0);\n\n  const rows = db\n    .prepare(\n      `\n      SELECT ${entryFields.join(\", \")}\n      FROM journal_entries\n      ${whereClause}\n      ORDER BY datetime(created_at) DESC\n      LIMIT @limit OFFSET @offset;\n    `,\n    )\n    .all({ ...params, limit, offset }) as EntryRow[];\n\n  const totalRow = db\n    .prepare(\n      `\n      SELECT COUNT(*) as total\n      FROM journal_entries\n      ${whereClause};\n    `,\n    )\n    .get(params) as { total: number };\n\n  return {\n    entries: rows.map(mapEntry),\n    total: totalRow?.total ?? 0,\n  };\n};\n\nexport const updateEntry = (\n  id: number,\n  patch: JournalEntryPatch,\n): JournalEntry => {\n  const db = getDb();\n  const fields: string[] = [];\n  const params: Record<string, unknown> = { id };\n\n  if (patch.promptId !== undefined) {\n    fields.push(\"prompt_id = @prompt_id\");\n    params.prompt_id = patch.promptId;\n  }\n  if (patch.promptText !== undefined) {\n    fields.push(\"prompt_text = @prompt_text\");\n    params.prompt_text = patch.promptText;\n  }\n  if (patch.category !== undefined) {\n    fields.push(\"category = @category\");\n    params.category = patch.category;\n  }\n  if (patch.projectTag !== undefined) {\n    fields.push(\"project_tag = @project_tag\");\n    params.project_tag = patch.projectTag;\n  }\n  if (patch.traitTag !== undefined) {\n    fields.push(\"trait_tag = @trait_tag\");\n    params.trait_tag = patch.traitTag;\n  }\n  if (patch.text !== undefined) {\n    fields.push(\"text = @text\");\n    params.text = patch.text;\n  }\n  if (patch.sentiment !== undefined) {\n    fields.push(\"sentiment = @sentiment\");\n    params.sentiment = patch.sentiment;\n  }\n  if (patch.meta !== undefined) {\n    fields.push(\"meta = @meta\");\n    params.meta = patch.meta ? JSON.stringify(patch.meta) : null;\n  }\n  if (patch.createdAt !== undefined) {\n    fields.push(\"created_at = @created_at\");\n    params.created_at = patch.createdAt;\n  }\n\n  if (!fields.length) {\n    return getEntryById(id);\n  }\n\n  db.prepare(\n    `\n      UPDATE journal_entries\n      SET ${fields.join(\", \")}\n      WHERE id = @id;\n    `,\n  ).run(params);\n\n  return getEntryById(id);\n};\n\nexport const deleteEntry = (id: number): void => {\n  const db = getDb();\n  db.prepare(\"DELETE FROM journal_entries WHERE id = ?;\").run(id);\n};\n\nexport const getRecentCategories = (limit = 10): Array<JournalEntry[\"category\"]> => {\n  const db = getDb();\n  const rows = db\n    .prepare(\n      `\n      SELECT category\n      FROM journal_entries\n      ORDER BY datetime(created_at) DESC\n      LIMIT ?;\n    `,\n    )\n    .all(limit) as Array<{ category: JournalEntry[\"category\"] }>;\n\n  return rows.map((row) => row.category);\n};\n\nexport const getRecentProjectTags = (limit = 10): string[] => {\n  const db = getDb();\n  const rows = db\n    .prepare(\n      `\n      SELECT project_tag as projectTag\n      FROM journal_entries\n      WHERE project_tag IS NOT NULL AND project_tag != ''\n      ORDER BY datetime(created_at) DESC\n      LIMIT ?;\n    `,\n    )\n    .all(limit) as Array<{ projectTag: string }>;\n\n  return rows.map((row) => row.projectTag);\n};\n\nexport const getStatsSnapshot = () => {\n  const db = getDb();\n  const startOfWeek = dayjs().startOf(\"week\").toISOString();\n\n  const total = db\n    .prepare(\n      `\n      SELECT COUNT(*) as count\n      FROM journal_entries\n      WHERE datetime(created_at) >= datetime(?);\n    `,\n    )\n    .get(startOfWeek) as { count: number };\n\n  const categoryCounts = db\n    .prepare(\n      `\n      SELECT category, COUNT(*) as count\n      FROM journal_entries\n      GROUP BY category\n      ORDER BY count DESC;\n    `,\n    )\n    .all() as Array<{ category: JournalEntry[\"category\"]; count: number }>;\n\n  const projectCounts = db\n    .prepare(\n      `\n      SELECT project_tag as projectTag, COUNT(*) as count\n      FROM journal_entries\n      WHERE project_tag IS NOT NULL AND project_tag != ''\n      GROUP BY project_tag\n      ORDER BY count DESC\n      LIMIT 5;\n    `,\n    )\n    .all() as Array<{ projectTag: string; count: number }>;\n\n  const traitCounts = db\n    .prepare(\n      `\n      SELECT trait_tag as traitTag, COUNT(*) as count\n      FROM journal_entries\n      WHERE trait_tag IS NOT NULL AND trait_tag != ''\n      GROUP BY trait_tag\n      ORDER BY count DESC\n      LIMIT 5;\n    `,\n    )\n    .all() as Array<{ traitTag: string; count: number }>;\n\n  return {\n    totalThisWeek: total?.count ?? 0,\n    categoryCounts,\n    projectCounts,\n    traitCounts,\n  };\n};\n\n","import { getDatabase } from \"../database\";\nimport type { Project } from \"../../src/types/taxonomy\";\n\nconst mapProject = (row: {\n  id: number;\n  name: string;\n  created_at: string;\n}): Project => ({\n  id: Number(row.id),\n  name: row.name,\n  createdAt: row.created_at,\n});\n\nexport const listProjects = (): Project[] => {\n  const db = getDatabase();\n  const rows = db\n    .prepare(\n      `\n      SELECT id, name, created_at\n      FROM projects\n      ORDER BY name ASC;\n    `,\n    )\n    .all() as Array<{ id: number; name: string; created_at: string }>;\n\n  return rows.map(mapProject);\n};\n\nexport const createProject = (name: string): Project => {\n  const db = getDatabase();\n  const result = db\n    .prepare(\n      `\n      INSERT INTO projects (name)\n      VALUES (?) ON CONFLICT(name) DO UPDATE SET name = excluded.name\n      RETURNING id, name, created_at;\n    `,\n    )\n    .get(name) as { id: number; name: string; created_at: string };\n\n  return mapProject(result);\n};\n\nexport const updateProject = (id: number, name: string): Project => {\n  const db = getDatabase();\n  db.prepare(\"UPDATE projects SET name = ? WHERE id = ?;\").run(name, id);\n\n  const row = db\n    .prepare(\n      `\n      SELECT id, name, created_at\n      FROM projects\n      WHERE id = ?;\n    `,\n    )\n    .get(id) as { id: number; name: string; created_at: string } | undefined;\n\n  if (!row) {\n    throw new Error(`Project ${id} not found`);\n  }\n\n  return mapProject(row);\n};\n\nexport const deleteProject = (id: number): void => {\n  const db = getDatabase();\n  db.prepare(\"DELETE FROM projects WHERE id = ?;\").run(id);\n};\n\n","import { getDatabase } from \"../database\";\nimport type {\n  Prompt,\n  PromptResult,\n  PromptSelectionContext,\n  TimeOfDay,\n} from \"../../src/types/prompt\";\nimport type { EntryCategory } from \"../../src/types/journal\";\nimport {\n  getRecentCategories,\n  getRecentProjectTags,\n} from \"./journalService\";\nimport { listProjects } from \"./projectsService\";\n\ninterface PromptRow {\n  id: number;\n  text: string;\n  category_id: number;\n  category: EntryCategory;\n  is_active: number;\n  requires_project: number;\n}\n\nconst mapPrompt = (row: PromptRow): Prompt => ({\n  id: Number(row.id),\n  text: row.text,\n  categoryId: Number(row.category_id),\n  category: row.category,\n  isActive: Boolean(row.is_active),\n  requiresProject: Boolean(row.requires_project),\n});\n\nconst timeCategoryPreferences: Record<TimeOfDay, EntryCategory[]> = {\n  morning: [\"identity\", \"productivity\", \"behavior\", \"project\"],\n  afternoon: [\"project\", \"productivity\", \"trait\"],\n  evening: [\"emotion\", \"trait\", \"small_win\"],\n  night: [\"emotion\", \"identity\", \"small_win\"],\n};\n\nconst getTimeOfDay = (date = new Date()): TimeOfDay => {\n  const hour = date.getHours();\n  if (hour >= 5 && hour < 12) return \"morning\";\n  if (hour >= 12 && hour < 17) return \"afternoon\";\n  if (hour >= 17 && hour < 22) return \"evening\";\n  return \"night\";\n};\n\nconst pickCategoryOrder = (\n  context: PromptSelectionContext,\n  availableCategories: EntryCategory[],\n) => {\n  const history = new Set(context.recentCategoryHistory.slice(0, 3));\n  const preference = timeCategoryPreferences[context.timeOfDay];\n\n  const combined = [\n    ...preference,\n    ...(context.activeProjectTags.length ? [\"project\"] : []),\n    ...availableCategories,\n  ];\n\n  const unique = Array.from(new Set(combined)).filter((category) =>\n    availableCategories.includes(category),\n  );\n\n  const prioritized = unique.filter((category) => !history.has(category));\n  return prioritized.length ? prioritized : unique;\n};\n\nexport const selectPrompt = (\n  context?: Partial<PromptSelectionContext>,\n): PromptResult | null => {\n  const db = getDatabase();\n\n  const rows = db\n    .prepare(\n      `\n      SELECT p.id,\n             p.text,\n             p.category_id,\n             c.name AS category,\n             p.is_active,\n             p.requires_project\n      FROM prompts p\n      JOIN prompt_categories c ON c.id = p.category_id\n      WHERE p.is_active = 1;\n    `,\n    )\n    .all() as PromptRow[];\n\n  if (!rows.length) {\n    return null;\n  }\n\n  const prompts = rows.map(mapPrompt);\n  const categories = Array.from(\n    new Set(prompts.map((prompt) => prompt.category)),\n  );\n\n  const fallbackRecentCategories = getRecentCategories(5);\n  const fallbackProjects = listProjects().map((project) => project.name);\n  const recentProjectTags =\n    getRecentProjectTags(5).concat(fallbackProjects).filter(Boolean);\n\n  const resolvedContext: PromptSelectionContext = {\n    timeOfDay: context?.timeOfDay ?? getTimeOfDay(),\n    recentCategoryHistory:\n      context?.recentCategoryHistory?.length\n        ? context.recentCategoryHistory\n        : fallbackRecentCategories,\n    activeProjectTags:\n      context?.activeProjectTags?.length\n        ? context.activeProjectTags\n        : Array.from(new Set(recentProjectTags)),\n  };\n\n  const categoryOrder = pickCategoryOrder(resolvedContext, categories);\n\n  for (const category of categoryOrder) {\n    const categoryPrompts = prompts.filter(\n      (prompt) => prompt.category === category,\n    );\n    if (!categoryPrompts.length) continue;\n\n    const prompt =\n      categoryPrompts[Math.floor(Math.random() * categoryPrompts.length)];\n\n    let projectTagSuggestion: string | null = null;\n    if (prompt.requiresProject && resolvedContext.activeProjectTags.length) {\n      projectTagSuggestion =\n        resolvedContext.activeProjectTags[\n          Math.floor(Math.random() * resolvedContext.activeProjectTags.length)\n        ];\n    }\n\n    return {\n      prompt,\n      projectTagSuggestion,\n    };\n  }\n\n  return {\n    prompt: prompts[Math.floor(Math.random() * prompts.length)],\n    projectTagSuggestion:\n      resolvedContext.activeProjectTags[0] ?? null,\n  };\n};\n\nexport const markPromptHandled = (): void => {\n  // Placeholder for future analytics (AI sentiment, prompt streaks, etc.)\n};\n\n","import { getDatabase } from \"../database\";\nimport type { AppSettings, SettingsPatch } from \"../../src/types/settings\";\n\nconst mapSettingsRow = (row: {\n  prompt_interval_minutes: number;\n  quiet_hours_start: string;\n  quiet_hours_end: string;\n  is_paused: number;\n}) =>\n  ({\n    promptIntervalMinutes: row.prompt_interval_minutes,\n    quietHoursStart: row.quiet_hours_start,\n    quietHoursEnd: row.quiet_hours_end,\n    isPaused: Boolean(row.is_paused),\n  }) satisfies AppSettings;\n\nexport const getSettings = (): AppSettings => {\n  const db = getDatabase();\n  const row = db\n    .prepare(\n      `\n      SELECT prompt_interval_minutes,\n             quiet_hours_start,\n             quiet_hours_end,\n             is_paused\n      FROM settings\n      WHERE id = 1;\n    `,\n    )\n    .get() as\n    | {\n        prompt_interval_minutes: number;\n        quiet_hours_start: string;\n        quiet_hours_end: string;\n        is_paused: number;\n      }\n    | undefined;\n\n  if (!row) {\n    throw new Error(\"Settings record missing\");\n  }\n\n  return mapSettingsRow(row);\n};\n\nexport const updateSettings = (patch: SettingsPatch): AppSettings => {\n  const db = getDatabase();\n  const fields: string[] = [];\n  const params: Record<string, unknown> = {};\n\n  if (patch.promptIntervalMinutes !== undefined) {\n    fields.push(\"prompt_interval_minutes = @prompt_interval_minutes\");\n    params.prompt_interval_minutes = patch.promptIntervalMinutes;\n  }\n  if (patch.quietHoursStart !== undefined) {\n    fields.push(\"quiet_hours_start = @quiet_hours_start\");\n    params.quiet_hours_start = patch.quietHoursStart;\n  }\n  if (patch.quietHoursEnd !== undefined) {\n    fields.push(\"quiet_hours_end = @quiet_hours_end\");\n    params.quiet_hours_end = patch.quietHoursEnd;\n  }\n  if (patch.isPaused !== undefined) {\n    fields.push(\"is_paused = @is_paused\");\n    params.is_paused = patch.isPaused ? 1 : 0;\n  }\n\n  if (fields.length) {\n    db.prepare(\n      `\n        UPDATE settings\n        SET ${fields.join(\", \")},\n            updated_at = CURRENT_TIMESTAMP\n        WHERE id = 1;\n      `,\n    ).run(params);\n  }\n\n  return getSettings();\n};\n\nexport const pausePrompts = (): AppSettings =>\n  updateSettings({ isPaused: true });\n\nexport const resumePrompts = (): AppSettings =>\n  updateSettings({ isPaused: false });\n\n","import { getDatabase } from \"../database\";\nimport type { Trait } from \"../../src/types/taxonomy\";\n\nconst mapTrait = (row: {\n  id: number;\n  name: string;\n  created_at: string;\n}): Trait => ({\n  id: Number(row.id),\n  name: row.name,\n  createdAt: row.created_at,\n});\n\nexport const listTraits = (): Trait[] => {\n  const db = getDatabase();\n  const rows = db\n    .prepare(\n      `\n      SELECT id, name, created_at\n      FROM traits\n      ORDER BY name ASC;\n    `,\n    )\n    .all() as Array<{ id: number; name: string; created_at: string }>;\n\n  return rows.map(mapTrait);\n};\n\nexport const createTrait = (name: string): Trait => {\n  const db = getDatabase();\n  const row = db\n    .prepare(\n      `\n      INSERT INTO traits (name)\n      VALUES (?) ON CONFLICT(name) DO UPDATE SET name = excluded.name\n      RETURNING id, name, created_at;\n    `,\n    )\n    .get(name) as { id: number; name: string; created_at: string };\n\n  return mapTrait(row);\n};\n\nexport const updateTrait = (id: number, name: string): Trait => {\n  const db = getDatabase();\n  db.prepare(\"UPDATE traits SET name = ? WHERE id = ?;\").run(name, id);\n\n  const row = db\n    .prepare(\n      `\n      SELECT id, name, created_at\n      FROM traits\n      WHERE id = ?;\n    `,\n    )\n    .get(id) as { id: number; name: string; created_at: string } | undefined;\n\n  if (!row) {\n    throw new Error(`Trait ${id} not found`);\n  }\n\n  return mapTrait(row);\n};\n\nexport const deleteTrait = (id: number): void => {\n  const db = getDatabase();\n  db.prepare(\"DELETE FROM traits WHERE id = ?;\").run(id);\n};\n\n","import type { InsightsSummary } from \"../../src/types/stats\";\nimport {\n  getStatsSnapshot,\n} from \"./journalService\";\n\nexport const buildInsightsSummary = (): InsightsSummary => {\n  const snapshot = getStatsSnapshot();\n\n  const mostFrequentCategory = snapshot.categoryCounts[0]?.category ?? null;\n  const mostActiveProject = snapshot.projectCounts[0]?.projectTag ?? null;\n  const mostActiveTrait = snapshot.traitCounts[0]?.traitTag ?? null;\n\n  return {\n    totalThisWeek: snapshot.totalThisWeek,\n    entriesByCategory: snapshot.categoryCounts.map((row) => ({\n      category: row.category,\n      count: row.count,\n    })),\n    topProjects: snapshot.projectCounts,\n    topTraits: snapshot.traitCounts,\n    mostFrequentCategory,\n    mostActiveProject,\n    mostActiveTrait,\n  };\n};\n\n","import { Menu, Tray, nativeImage, BrowserWindow } from \"electron\";\nimport type { AppSettings, SettingsPatch } from \"../src/types/settings\";\n\ninterface TrayOptions {\n  getMainWindow: () => BrowserWindow | null;\n  openMainWindow: () => void;\n  openPromptWindow: (options?: { quickEntry?: boolean }) => void;\n  pausePrompts: () => Promise<AppSettings>;\n  resumePrompts: () => Promise<AppSettings>;\n  getSettings: () => Promise<AppSettings>;\n  updateSettings: (patch: SettingsPatch) => Promise<AppSettings>;\n  refreshScheduler: () => void;\n  quit: () => void;\n}\n\nconst buildIcon = () => {\n  const svg = `\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"96\" height=\"96\" viewBox=\"0 0 96 96\">\n      <defs>\n        <linearGradient id=\"grad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n          <stop offset=\"0%\" stop-color=\"#8BB2D9\"/>\n          <stop offset=\"100%\" stop-color=\"#F5D8A5\"/>\n        </linearGradient>\n      </defs>\n      <rect width=\"96\" height=\"96\" rx=\"28\" fill=\"url(#grad)\"/>\n      <text x=\"48\" y=\"60\" text-anchor=\"middle\" font-family=\"Avenir, Helvetica, Arial, sans-serif\" font-size=\"44\" fill=\"#1F2933\" font-weight=\"600\">Q</text>\n    </svg>\n  `;\n  const svgUrl = `data:image/svg+xml;base64,${Buffer.from(svg).toString(\"base64\")}`;\n  return nativeImage.createFromDataURL(svgUrl).resize({ width: 22, height: 22 });\n};\n\nexport const createQuietQuestionsTray = async (options: TrayOptions) => {\n  const frequencyOptions = [30, 60, 90, 120];\n  const icon = buildIcon();\n  const tray = new Tray(icon);\n  tray.setToolTip(\"Quiet Questions\");\n  if (process.platform === \"darwin\") {\n    tray.setTitle(\"QQ\");\n  }\n\n  if (process.env.NODE_ENV === \"development\") {\n    console.log(\"[QuietQuestions] Tray ready\");\n  }\n\n  const refreshMenu = async () => {\n    const settings = await options.getSettings();\n    tray.setContextMenu(\n      Menu.buildFromTemplate([\n        {\n          label: \"Open Quiet Questions\",\n          click: () => options.openMainWindow(),\n        },\n        {\n          label: \"New quick entry…\",\n          click: () => options.openPromptWindow({ quickEntry: true }),\n        },\n        {\n          type: \"separator\",\n        },\n        {\n          label: \"Prompt frequency\",\n          submenu: frequencyOptions.map((minutes) => ({\n            label: `Every ${minutes} minutes`,\n            type: \"radio\",\n            checked: settings.promptIntervalMinutes === minutes,\n            click: async () => {\n              try {\n                await options.updateSettings({ promptIntervalMinutes: minutes });\n                options.refreshScheduler();\n              } catch (error) {\n                console.error(\"[QuietQuestions] Failed to update frequency\", error);\n              } finally {\n                refreshMenu();\n              }\n            },\n          })),\n        },\n        {\n          label: settings.isPaused ? \"Resume prompts\" : \"Pause prompts\",\n          click: async () => {\n            if (settings.isPaused) {\n              await options.resumePrompts();\n            } else {\n              await options.pausePrompts();\n            }\n            refreshMenu();\n          },\n        },\n        {\n          type: \"separator\",\n        },\n        {\n          label: \"Quit\",\n          role: \"quit\",\n          click: () => options.quit(),\n        },\n      ]),\n    );\n  };\n\n  tray.on(\"click\", () => {\n    tray.popUpContextMenu();\n  });\n\n  await refreshMenu();\n  return tray;\n};\n\n","import type { AppSettings } from \"../src/types/settings\";\n\ninterface PromptSchedulerOptions {\n  getSettings: () => AppSettings;\n  isPromptWindowOpen: () => boolean;\n  openPromptWindow: () => void;\n}\n\nconst minutesToMilliseconds = (minutes: number) => Math.max(minutes, 1) * 60 * 1000;\n\nconst parseTimeToMinutes = (value: string): number => {\n  const [hours = \"0\", minutes = \"0\"] = value.split(\":\");\n  return Number(hours) * 60 + Number(minutes);\n};\n\nconst isWithinQuietHours = (settings: AppSettings, now = new Date()): boolean => {\n  const start = parseTimeToMinutes(settings.quietHoursStart);\n  const end = parseTimeToMinutes(settings.quietHoursEnd);\n  const current = now.getHours() * 60 + now.getMinutes();\n\n  if (start === end) {\n    return false;\n  }\n\n  if (start < end) {\n    return current >= start && current < end;\n  }\n\n  // quiet hours span overnight\n  return current >= start || current < end;\n};\n\nconst getMillisecondsUntilQuietEnds = (\n  settings: AppSettings,\n  now = new Date(),\n): number => {\n  const quietEnd = parseTimeToMinutes(settings.quietHoursEnd);\n  const current = now.getHours() * 60 + now.getMinutes();\n\n  let minutesUntilEnd = quietEnd - current;\n  if (minutesUntilEnd <= 0) {\n    minutesUntilEnd += 24 * 60;\n  }\n\n  return minutesUntilEnd * 60 * 1000;\n};\n\nexport class PromptScheduler {\n  private timer: NodeJS.Timeout | null = null;\n\n  constructor(private readonly options: PromptSchedulerOptions) {}\n\n  start() {\n    this.clearTimer();\n    this.scheduleNext(0);\n  }\n\n  refresh() {\n    this.start();\n  }\n\n  snooze(minutes: number) {\n    this.clearTimer();\n    this.scheduleNext(minutesToMilliseconds(minutes));\n  }\n\n  stop() {\n    this.clearTimer();\n  }\n\n  private scheduleNext(delay: number) {\n    this.clearTimer();\n    this.timer = setTimeout(() => this.tick(), Math.max(delay, 1000));\n  }\n\n  private tick() {\n    const settings = this.options.getSettings();\n\n    if (settings.isPaused) {\n      this.scheduleNext(minutesToMilliseconds(settings.promptIntervalMinutes));\n      return;\n    }\n\n    if (this.options.isPromptWindowOpen()) {\n      this.scheduleNext(minutesToMilliseconds(5));\n      return;\n    }\n\n    if (isWithinQuietHours(settings)) {\n      this.scheduleNext(getMillisecondsUntilQuietEnds(settings));\n      return;\n    }\n\n    this.options.openPromptWindow();\n    this.scheduleNext(minutesToMilliseconds(settings.promptIntervalMinutes));\n  }\n\n  private clearTimer() {\n    if (this.timer) {\n      clearTimeout(this.timer);\n      this.timer = null;\n    }\n  }\n}\n\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAAA,oBAAiB;AACjB,IAAAC,mBAAsD;;;ACDtD,qBAAe;AACf,uBAAiB;AACjB,sBAAoB;AACpB,4BAAqB;AAyBrB,IAAI,KAA+B;AAE5B,IAAM,cAAc,MAAyB;AAClD,MAAI,IAAI;AACN,WAAO;AAAA,EACT;AAEA,QAAM,eAAe,oBAAI,QAAQ,UAAU;AAC3C,QAAM,cAAc,iBAAAC,QAAK,KAAK,cAAc,SAAS;AACrD,MAAI,CAAC,eAAAC,QAAG,WAAW,WAAW,GAAG;AAC/B,mBAAAA,QAAG,UAAU,aAAa,EAAE,WAAW,KAAK,CAAC;AAAA,EAC/C;AAEA,QAAM,SAAS,iBAAAD,QAAK,KAAK,aAAa,oBAAoB;AAC1D,OAAK,IAAI,sBAAAE,QAAS,MAAM;AAExB,KAAG,OAAO,oBAAoB;AAC9B,KAAG,OAAO,mBAAmB;AAE7B,gBAAc,EAAE;AAChB,iBAAe,EAAE;AAEjB,SAAO;AACT;AAEA,IAAM,gBAAgB,CAAC,aAAgC;AACrD,WACG;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMF,EACC,IAAI;AAEP,WACG;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWF,EACC,IAAI;AAEP,WACG;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeF,EACC,IAAI;AAEP,WACG;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOF,EACC,IAAI;AAEP,WACG;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOF,EACC,IAAI;AAEP,WACG;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUF,EACC,IAAI;AACT;AAEA,IAAM,iBAAiB,CAAC,aAAgC;AACtD,QAAM,mBAAmB,SACtB,QAAQ,sDAAsD,EAC9D,IAAI;AACP,MAAI,CAAC,iBAAiB,OAAO;AAC3B,aACG;AAAA,MACC;AAAA;AAAA;AAAA;AAAA,IAIF,EACC,IAAI;AAAA,EACT;AAEA,QAAM,aAA8B;AAAA,IAClC;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF;AAEA,QAAM,iBAAiB,SAAS;AAAA,IAC9B;AAAA,EACF;AACA,aAAW,QAAQ,CAAC,iBAAiB,eAAe,IAAI,YAAY,CAAC;AAErE,QAAM,cAID;AAAA,IACH;AAAA,MACE,MAAM;AAAA,MACN,UAAU;AAAA,MACV,iBAAiB;AAAA,IACnB;AAAA,IACA;AAAA,MACE,MAAM;AAAA,MACN,UAAU;AAAA,MACV,iBAAiB;AAAA,IACnB;AAAA,IACA;AAAA,MACE,MAAM;AAAA,MACN,UAAU;AAAA,IACZ;AAAA,IACA;AAAA,MACE,MAAM;AAAA,MACN,UAAU;AAAA,IACZ;AAAA,IACA;AAAA,MACE,MAAM;AAAA,MACN,UAAU;AAAA,IACZ;AAAA,IACA;AAAA,MACE,MAAM;AAAA,MACN,UAAU;AAAA,IACZ;AAAA,IACA;AAAA,MACE,MAAM;AAAA,MACN,UAAU;AAAA,IACZ;AAAA,IACA;AAAA,MACE,MAAM;AAAA,MACN,UAAU;AAAA,IACZ;AAAA,IACA;AAAA,MACE,MAAM;AAAA,MACN,UAAU;AAAA,IACZ;AAAA,IACA;AAAA,MACE,MAAM;AAAA,MACN,UAAU;AAAA,IACZ;AAAA,IACA;AAAA,MACE,MAAM;AAAA,MACN,UAAU;AAAA,IACZ;AAAA,IACA;AAAA,MACE,MAAM;AAAA,MACN,UAAU;AAAA,IACZ;AAAA,EACF;AAEA,QAAM,eAAe,SAAS;AAAA,IAC5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASF;AAEA,QAAM,kBAAkB,oBAAI,IAAY;AACxC,QAAM,aAAa,SAChB,QAAQ,2BAA2B,EACnC,IAAI;AACP,aAAW,QAAQ,CAAC,QAAQ,gBAAgB,IAAI,IAAI,IAAI,CAAC;AAEzD,cAAY,QAAQ,CAAC,WAAW;AAC9B,QAAI,CAAC,gBAAgB,IAAI,OAAO,IAAI,GAAG;AACrC,mBAAa,IAAI;AAAA,QACf,MAAM,OAAO;AAAA,QACb,UAAU,OAAO;AAAA,QACjB,kBAAkB,OAAO,kBAAkB,IAAI;AAAA,MACjD,CAAC;AAAA,IACH;AAAA,EACF,CAAC;AACH;;;AC9PA,IAAAC,mBAAqC;AAO9B,IAAM,mBAAmB,CAAC;AAAA,EAC/B;AAAA,EACA;AACF,MAA8C;AAC5C,QAAM,SAAS,IAAI,+BAAc;AAAA,IAC/B,OAAO;AAAA,IACP,QAAQ;AAAA,IACR,UAAU;AAAA,IACV,WAAW;AAAA,IACX,OAAO;AAAA,IACP,iBAAiB;AAAA,IACjB,MAAM;AAAA,IACN,eAAe;AAAA,IACf,sBAAsB,EAAE,GAAG,IAAI,GAAG,GAAG;AAAA,IACrC,gBAAgB;AAAA,MACd,SAAS;AAAA,MACT,iBAAiB;AAAA,MACjB,kBAAkB;AAAA,MAClB,SAAS;AAAA,MACT,YAAY;AAAA,IACd;AAAA,EACF,CAAC;AAED,SAAO,KAAK,iBAAiB,MAAM;AACjC,QAAI,CAAC,OAAO,YAAY,GAAG;AACzB,aAAO,KAAK;AAAA,IACd;AAAA,EACF,CAAC;AAED,SAAO,YAAY,qBAAqB,CAAC,EAAE,IAAI,MAAM;AACnD,2BAAM,aAAa,GAAG;AACtB,WAAO,EAAE,QAAQ,OAAO;AAAA,EAC1B,CAAC;AAED,QAAM,YAAY,YAAY,SAAS,GAAG,IACtC,GAAG,WAAW,OACd,GAAG,WAAW;AAClB,SAAO,QAAQ,SAAS;AAExB,SAAO;AACT;;;AChDA,IAAAC,mBAA8B;AAQvB,IAAM,qBAAqB,CAAC;AAAA,EACjC;AAAA,EACA;AAAA,EACA;AACF,MAAgD;AAC9C,QAAM,SAAS,IAAI,+BAAc;AAAA,IAC/B,OAAO;AAAA,IACP,QAAQ;AAAA,IACR,WAAW;AAAA,IACX,aAAa;AAAA,IACb,aAAa;AAAA,IACb,aAAa;AAAA,IACb,MAAM;AAAA,IACN,OAAO;AAAA,IACP,OAAO,aAAa,uCAAkC;AAAA,IACtD,iBAAiB;AAAA,IACjB,gBAAgB;AAAA,MACd,SAAS;AAAA,MACT,iBAAiB;AAAA,MACjB,kBAAkB;AAAA,MAClB,SAAS;AAAA,MACT,YAAY;AAAA,IACd;AAAA,EACF,CAAC;AAED,SAAO,KAAK,iBAAiB,MAAM,OAAO,KAAK,CAAC;AAEhD,QAAM,UAAU,YAAY,SAAS,GAAG,IACpC,GAAG,WAAW,aACd,GAAG,WAAW;AAClB,QAAM,MAAM,aAAa,GAAG,OAAO,aAAa;AAEhD,SAAO,QAAQ,GAAG;AAClB,SAAO;AACT;;;AC1CA,IAAAC,mBAAwB;;;ACCxB,mBAAkB;AASlB,IAAM,cAAc;AAAA,EAClB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;AAIA,IAAM,WAAW,CAAC,SAAiC;AAAA,EACjD,IAAI,OAAO,IAAI,EAAE;AAAA,EACjB,WAAW,OAAO,IAAI,UAAU;AAAA,EAChC,UAAU,IAAI,cAAc,OAAO,OAAO,IAAI,SAAS,IAAI;AAAA,EAC3D,YAAY,IAAI,gBAAgB,OAAO,OAAO,IAAI,WAAW,IAAI;AAAA,EACjE,UAAU,IAAI;AAAA,EACd,YAAY,IAAI,gBAAgB,OAAO,OAAO,IAAI,WAAW,IAAI;AAAA,EACjE,UAAU,IAAI,cAAc,OAAO,OAAO,IAAI,SAAS,IAAI;AAAA,EAC3D,MAAM,OAAO,IAAI,QAAQ,EAAE;AAAA,EAC3B,WAAW,IAAI,cAAc,OAAO,OAAO,IAAI,SAAS,IAAI;AAAA,EAC5D,MACE,OAAO,IAAI,SAAS,YAAY,IAAI,KAAK,SACpC,KAAK,MAAM,OAAO,IAAI,IAAI,CAAC,IAC5B;AACR;AAEA,IAAM,QAAQ,MAAyB,YAAY;AAE5C,IAAM,cAAc,CAAC,UAA2C;AACrE,QAAMC,MAAK,MAAM;AACjB,QAAM,YAAY,MAAM,cAAa,oBAAI,KAAK,GAAE,YAAY;AAC5D,QAAM,SAASA,IACZ;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAuBF,EACC,IAAI;AAAA,IACH,YAAY;AAAA,IACZ,WAAW,MAAM,YAAY;AAAA,IAC7B,aAAa,MAAM,cAAc;AAAA,IACjC,UAAU,MAAM;AAAA,IAChB,aAAa,MAAM,cAAc;AAAA,IACjC,WAAW,MAAM,YAAY;AAAA,IAC7B,MAAM,MAAM;AAAA,IACZ,WAAW,MAAM,aAAa;AAAA,IAC9B,MAAM,MAAM,OAAO,KAAK,UAAU,MAAM,IAAI,IAAI;AAAA,EAClD,CAAC;AAEH,SAAO,aAAa,OAAO,OAAO,eAAe,CAAC;AACpD;AAEO,IAAM,eAAe,CAAC,OAA6B;AACxD,QAAMA,MAAK,MAAM;AACjB,QAAM,MAAMA,IACT;AAAA,IACC;AAAA,eACS,YAAY,KAAK,IAAI,CAAC;AAAA;AAAA;AAAA;AAAA,EAIjC,EACC,IAAI,EAAE;AAET,MAAI,CAAC,KAAK;AACR,UAAM,IAAI,MAAM,SAAS,EAAE,YAAY;AAAA,EACzC;AAEA,SAAO,SAAS,GAAG;AACrB;AAEO,IAAM,aAAa,CACxB,YAC+C;AAC/C,QAAMA,MAAK,MAAM;AACjB,QAAM,QAAkB,CAAC;AACzB,QAAM,SAAkC,CAAC;AAEzC,MAAI,QAAQ,UAAU;AACpB,UAAM,KAAK,6CAA6C;AACxD,WAAO,WAAW,QAAQ;AAAA,EAC5B;AACA,MAAI,QAAQ,QAAQ;AAClB,UAAM,KAAK,2CAA2C;AACtD,WAAO,SAAS,QAAQ;AAAA,EAC1B;AACA,MAAI,QAAQ,UAAU;AACpB,UAAM,KAAK,sBAAsB;AACjC,WAAO,WAAW,QAAQ;AAAA,EAC5B;AACA,MAAI,QAAQ,YAAY;AACtB,UAAM,KAAK,2BAA2B;AACtC,WAAO,aAAa,QAAQ;AAAA,EAC9B;AACA,MAAI,QAAQ,UAAU;AACpB,UAAM,KAAK,uBAAuB;AAClC,WAAO,WAAW,QAAQ;AAAA,EAC5B;AAEA,QAAM,cAAc,MAAM,SAAS,SAAS,MAAM,KAAK,OAAO,CAAC,KAAK;AACpE,QAAM,QAAQ,OAAO,QAAQ,SAAS,EAAE;AACxC,QAAM,SAAS,OAAO,QAAQ,UAAU,CAAC;AAEzC,QAAM,OAAOA,IACV;AAAA,IACC;AAAA,eACS,YAAY,KAAK,IAAI,CAAC;AAAA;AAAA,QAE7B,WAAW;AAAA;AAAA;AAAA;AAAA,EAIf,EACC,IAAI,EAAE,GAAG,QAAQ,OAAO,OAAO,CAAC;AAEnC,QAAM,WAAWA,IACd;AAAA,IACC;AAAA;AAAA;AAAA,QAGE,WAAW;AAAA;AAAA,EAEf,EACC,IAAI,MAAM;AAEb,SAAO;AAAA,IACL,SAAS,KAAK,IAAI,QAAQ;AAAA,IAC1B,OAAO,UAAU,SAAS;AAAA,EAC5B;AACF;AAEO,IAAM,cAAc,CACzB,IACA,UACiB;AACjB,QAAMA,MAAK,MAAM;AACjB,QAAM,SAAmB,CAAC;AAC1B,QAAM,SAAkC,EAAE,GAAG;AAE7C,MAAI,MAAM,aAAa,QAAW;AAChC,WAAO,KAAK,wBAAwB;AACpC,WAAO,YAAY,MAAM;AAAA,EAC3B;AACA,MAAI,MAAM,eAAe,QAAW;AAClC,WAAO,KAAK,4BAA4B;AACxC,WAAO,cAAc,MAAM;AAAA,EAC7B;AACA,MAAI,MAAM,aAAa,QAAW;AAChC,WAAO,KAAK,sBAAsB;AAClC,WAAO,WAAW,MAAM;AAAA,EAC1B;AACA,MAAI,MAAM,eAAe,QAAW;AAClC,WAAO,KAAK,4BAA4B;AACxC,WAAO,cAAc,MAAM;AAAA,EAC7B;AACA,MAAI,MAAM,aAAa,QAAW;AAChC,WAAO,KAAK,wBAAwB;AACpC,WAAO,YAAY,MAAM;AAAA,EAC3B;AACA,MAAI,MAAM,SAAS,QAAW;AAC5B,WAAO,KAAK,cAAc;AAC1B,WAAO,OAAO,MAAM;AAAA,EACtB;AACA,MAAI,MAAM,cAAc,QAAW;AACjC,WAAO,KAAK,wBAAwB;AACpC,WAAO,YAAY,MAAM;AAAA,EAC3B;AACA,MAAI,MAAM,SAAS,QAAW;AAC5B,WAAO,KAAK,cAAc;AAC1B,WAAO,OAAO,MAAM,OAAO,KAAK,UAAU,MAAM,IAAI,IAAI;AAAA,EAC1D;AACA,MAAI,MAAM,cAAc,QAAW;AACjC,WAAO,KAAK,0BAA0B;AACtC,WAAO,aAAa,MAAM;AAAA,EAC5B;AAEA,MAAI,CAAC,OAAO,QAAQ;AAClB,WAAO,aAAa,EAAE;AAAA,EACxB;AAEA,EAAAA,IAAG;AAAA,IACD;AAAA;AAAA,YAEQ,OAAO,KAAK,IAAI,CAAC;AAAA;AAAA;AAAA,EAG3B,EAAE,IAAI,MAAM;AAEZ,SAAO,aAAa,EAAE;AACxB;AAEO,IAAM,cAAc,CAAC,OAAqB;AAC/C,QAAMA,MAAK,MAAM;AACjB,EAAAA,IAAG,QAAQ,2CAA2C,EAAE,IAAI,EAAE;AAChE;AAEO,IAAM,sBAAsB,CAAC,QAAQ,OAAwC;AAClF,QAAMA,MAAK,MAAM;AACjB,QAAM,OAAOA,IACV;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMF,EACC,IAAI,KAAK;AAEZ,SAAO,KAAK,IAAI,CAAC,QAAQ,IAAI,QAAQ;AACvC;AAEO,IAAM,uBAAuB,CAAC,QAAQ,OAAiB;AAC5D,QAAMA,MAAK,MAAM;AACjB,QAAM,OAAOA,IACV;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOF,EACC,IAAI,KAAK;AAEZ,SAAO,KAAK,IAAI,CAAC,QAAQ,IAAI,UAAU;AACzC;AAEO,IAAM,mBAAmB,MAAM;AACpC,QAAMA,MAAK,MAAM;AACjB,QAAM,kBAAc,aAAAC,SAAM,EAAE,QAAQ,MAAM,EAAE,YAAY;AAExD,QAAM,QAAQD,IACX;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA,EAKF,EACC,IAAI,WAAW;AAElB,QAAM,iBAAiBA,IACpB;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMF,EACC,IAAI;AAEP,QAAM,gBAAgBA,IACnB;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQF,EACC,IAAI;AAEP,QAAM,cAAcA,IACjB;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQF,EACC,IAAI;AAEP,SAAO;AAAA,IACL,eAAe,OAAO,SAAS;AAAA,IAC/B;AAAA,IACA;AAAA,IACA;AAAA,EACF;AACF;;;AC9TA,IAAM,aAAa,CAAC,SAIJ;AAAA,EACd,IAAI,OAAO,IAAI,EAAE;AAAA,EACjB,MAAM,IAAI;AAAA,EACV,WAAW,IAAI;AACjB;AAEO,IAAM,eAAe,MAAiB;AAC3C,QAAME,MAAK,YAAY;AACvB,QAAM,OAAOA,IACV;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA,EAKF,EACC,IAAI;AAEP,SAAO,KAAK,IAAI,UAAU;AAC5B;AAEO,IAAM,gBAAgB,CAAC,SAA0B;AACtD,QAAMA,MAAK,YAAY;AACvB,QAAM,SAASA,IACZ;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA,EAKF,EACC,IAAI,IAAI;AAEX,SAAO,WAAW,MAAM;AAC1B;AAEO,IAAM,gBAAgB,CAAC,IAAY,SAA0B;AAClE,QAAMA,MAAK,YAAY;AACvB,EAAAA,IAAG,QAAQ,4CAA4C,EAAE,IAAI,MAAM,EAAE;AAErE,QAAM,MAAMA,IACT;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA,EAKF,EACC,IAAI,EAAE;AAET,MAAI,CAAC,KAAK;AACR,UAAM,IAAI,MAAM,WAAW,EAAE,YAAY;AAAA,EAC3C;AAEA,SAAO,WAAW,GAAG;AACvB;AAEO,IAAM,gBAAgB,CAAC,OAAqB;AACjD,QAAMA,MAAK,YAAY;AACvB,EAAAA,IAAG,QAAQ,oCAAoC,EAAE,IAAI,EAAE;AACzD;;;AC5CA,IAAM,YAAY,CAAC,SAA4B;AAAA,EAC7C,IAAI,OAAO,IAAI,EAAE;AAAA,EACjB,MAAM,IAAI;AAAA,EACV,YAAY,OAAO,IAAI,WAAW;AAAA,EAClC,UAAU,IAAI;AAAA,EACd,UAAU,QAAQ,IAAI,SAAS;AAAA,EAC/B,iBAAiB,QAAQ,IAAI,gBAAgB;AAC/C;AAEA,IAAM,0BAA8D;AAAA,EAClE,SAAS,CAAC,YAAY,gBAAgB,YAAY,SAAS;AAAA,EAC3D,WAAW,CAAC,WAAW,gBAAgB,OAAO;AAAA,EAC9C,SAAS,CAAC,WAAW,SAAS,WAAW;AAAA,EACzC,OAAO,CAAC,WAAW,YAAY,WAAW;AAC5C;AAEA,IAAM,eAAe,CAAC,OAAO,oBAAI,KAAK,MAAiB;AACrD,QAAM,OAAO,KAAK,SAAS;AAC3B,MAAI,QAAQ,KAAK,OAAO,GAAI,QAAO;AACnC,MAAI,QAAQ,MAAM,OAAO,GAAI,QAAO;AACpC,MAAI,QAAQ,MAAM,OAAO,GAAI,QAAO;AACpC,SAAO;AACT;AAEA,IAAM,oBAAoB,CACxB,SACA,wBACG;AACH,QAAM,UAAU,IAAI,IAAI,QAAQ,sBAAsB,MAAM,GAAG,CAAC,CAAC;AACjE,QAAM,aAAa,wBAAwB,QAAQ,SAAS;AAE5D,QAAM,WAAW;AAAA,IACf,GAAG;AAAA,IACH,GAAI,QAAQ,kBAAkB,SAAS,CAAC,SAAS,IAAI,CAAC;AAAA,IACtD,GAAG;AAAA,EACL;AAEA,QAAM,SAAS,MAAM,KAAK,IAAI,IAAI,QAAQ,CAAC,EAAE;AAAA,IAAO,CAAC,aACnD,oBAAoB,SAAS,QAAQ;AAAA,EACvC;AAEA,QAAM,cAAc,OAAO,OAAO,CAAC,aAAa,CAAC,QAAQ,IAAI,QAAQ,CAAC;AACtE,SAAO,YAAY,SAAS,cAAc;AAC5C;AAEO,IAAM,eAAe,CAC1B,YACwB;AACxB,QAAMC,MAAK,YAAY;AAEvB,QAAM,OAAOA,IACV;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWF,EACC,IAAI;AAEP,MAAI,CAAC,KAAK,QAAQ;AAChB,WAAO;AAAA,EACT;AAEA,QAAM,UAAU,KAAK,IAAI,SAAS;AAClC,QAAM,aAAa,MAAM;AAAA,IACvB,IAAI,IAAI,QAAQ,IAAI,CAAC,WAAW,OAAO,QAAQ,CAAC;AAAA,EAClD;AAEA,QAAM,2BAA2B,oBAAoB,CAAC;AACtD,QAAM,mBAAmB,aAAa,EAAE,IAAI,CAAC,YAAY,QAAQ,IAAI;AACrE,QAAM,oBACJ,qBAAqB,CAAC,EAAE,OAAO,gBAAgB,EAAE,OAAO,OAAO;AAEjE,QAAM,kBAA0C;AAAA,IAC9C,WAAW,SAAS,aAAa,aAAa;AAAA,IAC9C,uBACE,SAAS,uBAAuB,SAC5B,QAAQ,wBACR;AAAA,IACN,mBACE,SAAS,mBAAmB,SACxB,QAAQ,oBACR,MAAM,KAAK,IAAI,IAAI,iBAAiB,CAAC;AAAA,EAC7C;AAEA,QAAM,gBAAgB,kBAAkB,iBAAiB,UAAU;AAEnE,aAAW,YAAY,eAAe;AACpC,UAAM,kBAAkB,QAAQ;AAAA,MAC9B,CAACC,YAAWA,QAAO,aAAa;AAAA,IAClC;AACA,QAAI,CAAC,gBAAgB,OAAQ;AAE7B,UAAM,SACJ,gBAAgB,KAAK,MAAM,KAAK,OAAO,IAAI,gBAAgB,MAAM,CAAC;AAEpE,QAAI,uBAAsC;AAC1C,QAAI,OAAO,mBAAmB,gBAAgB,kBAAkB,QAAQ;AACtE,6BACE,gBAAgB,kBACd,KAAK,MAAM,KAAK,OAAO,IAAI,gBAAgB,kBAAkB,MAAM,CACrE;AAAA,IACJ;AAEA,WAAO;AAAA,MACL;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAEA,SAAO;AAAA,IACL,QAAQ,QAAQ,KAAK,MAAM,KAAK,OAAO,IAAI,QAAQ,MAAM,CAAC;AAAA,IAC1D,sBACE,gBAAgB,kBAAkB,CAAC,KAAK;AAAA,EAC5C;AACF;AAEO,IAAM,oBAAoB,MAAY;AAE7C;;;AClJA,IAAM,iBAAiB,CAAC,SAMrB;AAAA,EACC,uBAAuB,IAAI;AAAA,EAC3B,iBAAiB,IAAI;AAAA,EACrB,eAAe,IAAI;AAAA,EACnB,UAAU,QAAQ,IAAI,SAAS;AACjC;AAEK,IAAM,cAAc,MAAmB;AAC5C,QAAMC,MAAK,YAAY;AACvB,QAAM,MAAMA,IACT;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQF,EACC,IAAI;AASP,MAAI,CAAC,KAAK;AACR,UAAM,IAAI,MAAM,yBAAyB;AAAA,EAC3C;AAEA,SAAO,eAAe,GAAG;AAC3B;AAEO,IAAM,iBAAiB,CAAC,UAAsC;AACnE,QAAMA,MAAK,YAAY;AACvB,QAAM,SAAmB,CAAC;AAC1B,QAAM,SAAkC,CAAC;AAEzC,MAAI,MAAM,0BAA0B,QAAW;AAC7C,WAAO,KAAK,oDAAoD;AAChE,WAAO,0BAA0B,MAAM;AAAA,EACzC;AACA,MAAI,MAAM,oBAAoB,QAAW;AACvC,WAAO,KAAK,wCAAwC;AACpD,WAAO,oBAAoB,MAAM;AAAA,EACnC;AACA,MAAI,MAAM,kBAAkB,QAAW;AACrC,WAAO,KAAK,oCAAoC;AAChD,WAAO,kBAAkB,MAAM;AAAA,EACjC;AACA,MAAI,MAAM,aAAa,QAAW;AAChC,WAAO,KAAK,wBAAwB;AACpC,WAAO,YAAY,MAAM,WAAW,IAAI;AAAA,EAC1C;AAEA,MAAI,OAAO,QAAQ;AACjB,IAAAA,IAAG;AAAA,MACD;AAAA;AAAA,cAEQ,OAAO,KAAK,IAAI,CAAC;AAAA;AAAA;AAAA;AAAA,IAI3B,EAAE,IAAI,MAAM;AAAA,EACd;AAEA,SAAO,YAAY;AACrB;AAEO,IAAM,eAAe,MAC1B,eAAe,EAAE,UAAU,KAAK,CAAC;AAE5B,IAAM,gBAAgB,MAC3B,eAAe,EAAE,UAAU,MAAM,CAAC;;;AClFpC,IAAM,WAAW,CAAC,SAIJ;AAAA,EACZ,IAAI,OAAO,IAAI,EAAE;AAAA,EACjB,MAAM,IAAI;AAAA,EACV,WAAW,IAAI;AACjB;AAEO,IAAM,aAAa,MAAe;AACvC,QAAMC,MAAK,YAAY;AACvB,QAAM,OAAOA,IACV;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA,EAKF,EACC,IAAI;AAEP,SAAO,KAAK,IAAI,QAAQ;AAC1B;AAEO,IAAM,cAAc,CAAC,SAAwB;AAClD,QAAMA,MAAK,YAAY;AACvB,QAAM,MAAMA,IACT;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA,EAKF,EACC,IAAI,IAAI;AAEX,SAAO,SAAS,GAAG;AACrB;AAEO,IAAM,cAAc,CAAC,IAAY,SAAwB;AAC9D,QAAMA,MAAK,YAAY;AACvB,EAAAA,IAAG,QAAQ,0CAA0C,EAAE,IAAI,MAAM,EAAE;AAEnE,QAAM,MAAMA,IACT;AAAA,IACC;AAAA;AAAA;AAAA;AAAA;AAAA,EAKF,EACC,IAAI,EAAE;AAET,MAAI,CAAC,KAAK;AACR,UAAM,IAAI,MAAM,SAAS,EAAE,YAAY;AAAA,EACzC;AAEA,SAAO,SAAS,GAAG;AACrB;AAEO,IAAM,cAAc,CAAC,OAAqB;AAC/C,QAAMA,MAAK,YAAY;AACvB,EAAAA,IAAG,QAAQ,kCAAkC,EAAE,IAAI,EAAE;AACvD;;;AC9DO,IAAM,uBAAuB,MAAuB;AACzD,QAAM,WAAW,iBAAiB;AAElC,QAAM,uBAAuB,SAAS,eAAe,CAAC,GAAG,YAAY;AACrE,QAAM,oBAAoB,SAAS,cAAc,CAAC,GAAG,cAAc;AACnE,QAAM,kBAAkB,SAAS,YAAY,CAAC,GAAG,YAAY;AAE7D,SAAO;AAAA,IACL,eAAe,SAAS;AAAA,IACxB,mBAAmB,SAAS,eAAe,IAAI,CAAC,SAAS;AAAA,MACvD,UAAU,IAAI;AAAA,MACd,OAAO,IAAI;AAAA,IACb,EAAE;AAAA,IACF,aAAa,SAAS;AAAA,IACtB,WAAW,SAAS;AAAA,IACpB;AAAA,IACA;AAAA,IACA;AAAA,EACF;AACF;;;ANoBO,IAAM,sBAAsB,CAAC,QAA2B;AAC7D,2BAAQ;AAAA,IAAO;AAAA,IAAkB,OAAO,QAAQ,YAC9C,YAAY,OAAO;AAAA,EACrB;AAEA,2BAAQ;AAAA,IAAO;AAAA,IAAe,OAAO,QAAQ,YAC3C,WAAW,OAAO;AAAA,EACpB;AAEA,2BAAQ;AAAA,IACN;AAAA,IACA,OAAO,QAAQ,IAAY,UACzB,YAAY,IAAI,KAAK;AAAA,EACzB;AAEA,2BAAQ,OAAO,kBAAkB,OAAO,QAAQ,OAAe;AAC7D,gBAAY,EAAE;AACd,WAAO;AAAA,EACT,CAAC;AAED,2BAAQ;AAAA,IACN;AAAA,IACA,OAAO,QAAQ,YACb,aAAa,WAAW,MAAS;AAAA,EACrC;AAEA,2BAAQ;AAAA,IACN;AAAA,IACA,OAAO,QAAQ,UAAkB,WAAgC;AAC/D,wBAAkB;AAClB,aAAO,EAAE,UAAU,OAAO;AAAA,IAC5B;AAAA,EACF;AAEA,2BAAQ,OAAO,uBAAuB,YAAY;AAChD,QAAI,iBAAiB,EAAE,YAAY,KAAK,CAAC;AAAA,EAC3C,CAAC;AAED,2BAAQ,OAAO,kBAAkB,OAAO,QAAQ,YAAoB;AAClE,QAAI,aAAa,OAAO;AACxB,WAAO;AAAA,EACT,CAAC;AAED,2BAAQ,OAAO,gBAAgB,YAAY,YAAY,CAAC;AAExD,2BAAQ;AAAA,IACN;AAAA,IACA,OAAO,QAAQ,UAAyB;AACtC,YAAM,UAAU,eAAe,KAAK;AACpC,UAAI,iBAAiB;AACrB,aAAO;AAAA,IACT;AAAA,EACF;AAEA,2BAAQ,OAAO,kBAAkB,YAAY;AAC3C,UAAM,UAAU,aAAa;AAC7B,QAAI,iBAAiB;AACrB,WAAO;AAAA,EACT,CAAC;AACD,2BAAQ,OAAO,mBAAmB,YAAY;AAC5C,UAAM,UAAU,cAAc;AAC9B,QAAI,iBAAiB;AACrB,WAAO;AAAA,EACT,CAAC;AAED,2BAAQ,OAAO,iBAAiB,YAAY,aAAa,CAAC;AAC1D,2BAAQ;AAAA,IAAO;AAAA,IAAmB,OAAO,QAAQ,SAC/C,cAAc,IAAI;AAAA,EACpB;AACA,2BAAQ;AAAA,IACN;AAAA,IACA,OAAO,QAAQ,IAAY,SAAiB,cAAc,IAAI,IAAI;AAAA,EACpE;AACA,2BAAQ,OAAO,mBAAmB,OAAO,QAAQ,OAAe;AAC9D,kBAAc,EAAE;AAChB,WAAO;AAAA,EACT,CAAC;AAED,2BAAQ,OAAO,eAAe,YAAY,WAAW,CAAC;AACtD,2BAAQ;AAAA,IAAO;AAAA,IAAiB,OAAO,QAAQ,SAC7C,YAAY,IAAI;AAAA,EAClB;AACA,2BAAQ;AAAA,IACN;AAAA,IACA,OAAO,QAAQ,IAAY,SAAiB,YAAY,IAAI,IAAI;AAAA,EAClE;AACA,2BAAQ,OAAO,iBAAiB,OAAO,QAAQ,OAAe;AAC5D,gBAAY,EAAE;AACd,WAAO;AAAA,EACT,CAAC;AAED,2BAAQ,OAAO,aAAa,YAAY,qBAAqB,CAAC;AAGhE;;;AO1IA,IAAAC,mBAAuD;AAevD,IAAM,YAAY,MAAM;AACtB,QAAM,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAYZ,QAAM,SAAS,6BAA6B,OAAO,KAAK,GAAG,EAAE,SAAS,QAAQ,CAAC;AAC/E,SAAO,6BAAY,kBAAkB,MAAM,EAAE,OAAO,EAAE,OAAO,IAAI,QAAQ,GAAG,CAAC;AAC/E;AAEO,IAAM,2BAA2B,OAAO,YAAyB;AACtE,QAAM,mBAAmB,CAAC,IAAI,IAAI,IAAI,GAAG;AACzC,QAAM,OAAO,UAAU;AACvB,QAAMC,QAAO,IAAI,sBAAK,IAAI;AAC1B,EAAAA,MAAK,WAAW,iBAAiB;AACjC,MAAI,QAAQ,aAAa,UAAU;AACjC,IAAAA,MAAK,SAAS,IAAI;AAAA,EACpB;AAEA,MAAI,MAAwC;AAC1C,YAAQ,IAAI,6BAA6B;AAAA,EAC3C;AAEA,QAAM,cAAc,YAAY;AAC9B,UAAM,WAAW,MAAM,QAAQ,YAAY;AAC3C,IAAAA,MAAK;AAAA,MACH,sBAAK,kBAAkB;AAAA,QACrB;AAAA,UACE,OAAO;AAAA,UACP,OAAO,MAAM,QAAQ,eAAe;AAAA,QACtC;AAAA,QACA;AAAA,UACE,OAAO;AAAA,UACP,OAAO,MAAM,QAAQ,iBAAiB,EAAE,YAAY,KAAK,CAAC;AAAA,QAC5D;AAAA,QACA;AAAA,UACE,MAAM;AAAA,QACR;AAAA,QACA;AAAA,UACE,OAAO;AAAA,UACP,SAAS,iBAAiB,IAAI,CAAC,aAAa;AAAA,YAC1C,OAAO,SAAS,OAAO;AAAA,YACvB,MAAM;AAAA,YACN,SAAS,SAAS,0BAA0B;AAAA,YAC5C,OAAO,YAAY;AACjB,kBAAI;AACF,sBAAM,QAAQ,eAAe,EAAE,uBAAuB,QAAQ,CAAC;AAC/D,wBAAQ,iBAAiB;AAAA,cAC3B,SAAS,OAAO;AACd,wBAAQ,MAAM,+CAA+C,KAAK;AAAA,cACpE,UAAE;AACA,4BAAY;AAAA,cACd;AAAA,YACF;AAAA,UACF,EAAE;AAAA,QACJ;AAAA,QACA;AAAA,UACE,OAAO,SAAS,WAAW,mBAAmB;AAAA,UAC9C,OAAO,YAAY;AACjB,gBAAI,SAAS,UAAU;AACrB,oBAAM,QAAQ,cAAc;AAAA,YAC9B,OAAO;AACL,oBAAM,QAAQ,aAAa;AAAA,YAC7B;AACA,wBAAY;AAAA,UACd;AAAA,QACF;AAAA,QACA;AAAA,UACE,MAAM;AAAA,QACR;AAAA,QACA;AAAA,UACE,OAAO;AAAA,UACP,MAAM;AAAA,UACN,OAAO,MAAM,QAAQ,KAAK;AAAA,QAC5B;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF;AAEA,EAAAA,MAAK,GAAG,SAAS,MAAM;AACrB,IAAAA,MAAK,iBAAiB;AAAA,EACxB,CAAC;AAED,QAAM,YAAY;AAClB,SAAOA;AACT;;;ACnGA,IAAM,wBAAwB,CAAC,YAAoB,KAAK,IAAI,SAAS,CAAC,IAAI,KAAK;AAE/E,IAAM,qBAAqB,CAAC,UAA0B;AACpD,QAAM,CAAC,QAAQ,KAAK,UAAU,GAAG,IAAI,MAAM,MAAM,GAAG;AACpD,SAAO,OAAO,KAAK,IAAI,KAAK,OAAO,OAAO;AAC5C;AAEA,IAAM,qBAAqB,CAAC,UAAuB,MAAM,oBAAI,KAAK,MAAe;AAC/E,QAAM,QAAQ,mBAAmB,SAAS,eAAe;AACzD,QAAM,MAAM,mBAAmB,SAAS,aAAa;AACrD,QAAM,UAAU,IAAI,SAAS,IAAI,KAAK,IAAI,WAAW;AAErD,MAAI,UAAU,KAAK;AACjB,WAAO;AAAA,EACT;AAEA,MAAI,QAAQ,KAAK;AACf,WAAO,WAAW,SAAS,UAAU;AAAA,EACvC;AAGA,SAAO,WAAW,SAAS,UAAU;AACvC;AAEA,IAAM,gCAAgC,CACpC,UACA,MAAM,oBAAI,KAAK,MACJ;AACX,QAAM,WAAW,mBAAmB,SAAS,aAAa;AAC1D,QAAM,UAAU,IAAI,SAAS,IAAI,KAAK,IAAI,WAAW;AAErD,MAAI,kBAAkB,WAAW;AACjC,MAAI,mBAAmB,GAAG;AACxB,uBAAmB,KAAK;AAAA,EAC1B;AAEA,SAAO,kBAAkB,KAAK;AAChC;AAEO,IAAM,kBAAN,MAAsB;AAAA,EAG3B,YAA6B,SAAiC;AAAjC;AAF7B,SAAQ,QAA+B;AAAA,EAEwB;AAAA,EAE/D,QAAQ;AACN,SAAK,WAAW;AAChB,SAAK,aAAa,CAAC;AAAA,EACrB;AAAA,EAEA,UAAU;AACR,SAAK,MAAM;AAAA,EACb;AAAA,EAEA,OAAO,SAAiB;AACtB,SAAK,WAAW;AAChB,SAAK,aAAa,sBAAsB,OAAO,CAAC;AAAA,EAClD;AAAA,EAEA,OAAO;AACL,SAAK,WAAW;AAAA,EAClB;AAAA,EAEQ,aAAa,OAAe;AAClC,SAAK,WAAW;AAChB,SAAK,QAAQ,WAAW,MAAM,KAAK,KAAK,GAAG,KAAK,IAAI,OAAO,GAAI,CAAC;AAAA,EAClE;AAAA,EAEQ,OAAO;AACb,UAAM,WAAW,KAAK,QAAQ,YAAY;AAE1C,QAAI,SAAS,UAAU;AACrB,WAAK,aAAa,sBAAsB,SAAS,qBAAqB,CAAC;AACvE;AAAA,IACF;AAEA,QAAI,KAAK,QAAQ,mBAAmB,GAAG;AACrC,WAAK,aAAa,sBAAsB,CAAC,CAAC;AAC1C;AAAA,IACF;AAEA,QAAI,mBAAmB,QAAQ,GAAG;AAChC,WAAK,aAAa,8BAA8B,QAAQ,CAAC;AACzD;AAAA,IACF;AAEA,SAAK,QAAQ,iBAAiB;AAC9B,SAAK,aAAa,sBAAsB,SAAS,qBAAqB,CAAC;AAAA,EACzE;AAAA,EAEQ,aAAa;AACnB,QAAI,KAAK,OAAO;AACd,mBAAa,KAAK,KAAK;AACvB,WAAK,QAAQ;AAAA,IACf;AAAA,EACF;AACF;;;AZxFA,IAAI,aAAmC;AACvC,IAAI,eAAqC;AACzC,IAAI,OAAoB;AACxB,IAAI,YAAoC;AAExC,IAAM,iBAAiB,MAAM;AAC3B,QAAM,eAAe,QAAQ,IAAI;AACjC,MAAI,cAAc;AAChB,WAAO;AAAA,EACT;AAEA,SAAO,UAAU,kBAAAC,QAAK,KAAK,WAAW,wBAAwB,CAAC;AACjE;AAEA,IAAM,iBAAiB,MAAM,kBAAAA,QAAK,KAAK,WAAW,YAAY;AAE9D,IAAM,qBAAqB,MACzB,CAAC,CAAC,gBAAgB,CAAC,aAAa,YAAY;AAE9C,IAAM,iBAAiB,CAAC,WAA0B;AAChD,MAAI,OAAO,YAAY,GAAG;AACxB,WAAO,QAAQ;AAAA,EACjB;AACA,MAAI,CAAC,OAAO,UAAU,GAAG;AACvB,WAAO,KAAK;AAAA,EACd;AACA,SAAO,MAAM;AACf;AAEA,IAAM,iBAAiB,MAAM;AAC3B,MAAI,CAAC,cAAc,WAAW,YAAY,GAAG;AAC3C,iBAAa,iBAAiB;AAAA,MAC5B,aAAa,eAAe;AAAA,MAC5B,aAAa,eAAe;AAAA,IAC9B,CAAC;AAED,eAAW,GAAG,UAAU,MAAM;AAC5B,mBAAa;AAAA,IACf,CAAC;AAAA,EACH,OAAO;AACL,mBAAe,UAAU;AAAA,EAC3B;AACF;AAEA,IAAM,mBAAmB,CAAC,YAAuC;AAC/D,MAAI,gBAAgB,CAAC,aAAa,YAAY,GAAG;AAC/C,mBAAe,YAAY;AAC3B;AAAA,EACF;AAEA,iBAAe,mBAAmB;AAAA,IAChC,aAAa,eAAe;AAAA,IAC5B,aAAa,eAAe;AAAA,IAC5B,YAAY,SAAS;AAAA,EACvB,CAAC;AAED,eAAa,GAAG,UAAU,MAAM;AAC9B,mBAAe;AAAA,EACjB,CAAC;AACH;AAEA,IAAM,iBAAiB,MAAM;AAC3B,cAAY,IAAI,gBAAgB;AAAA,IAC9B;AAAA,IACA;AAAA,IACA,kBAAkB,MAAM,iBAAiB;AAAA,EAC3C,CAAC;AACD,YAAU,MAAM;AAClB;AAEA,IAAM,YAAY,YAAY;AAC5B,SAAO,MAAM,yBAAyB;AAAA,IACpC,eAAe,MAAM;AAAA,IACrB;AAAA,IACA;AAAA,IACA,cAAc,YAAY;AACxB,YAAM,WAAW,aAAa;AAC9B,iBAAW,QAAQ;AACnB,aAAO;AAAA,IACT;AAAA,IACA,eAAe,YAAY;AACzB,YAAM,WAAW,cAAc;AAC/B,iBAAW,QAAQ;AACnB,aAAO;AAAA,IACT;AAAA,IACA,aAAa,YAAY,YAAa;AAAA,IACtC,gBAAgB,OAAO,UAAU;AAC/B,YAAM,UAAU,eAAc,KAAK;AACnC,iBAAW,QAAQ;AACnB,aAAO;AAAA,IACT;AAAA,IACA,kBAAkB,MAAM,WAAW,QAAQ;AAAA,IAC3C,MAAM,MAAM;AACV,iBAAW,KAAK;AAChB,2BAAI,KAAK;AAAA,IACX;AAAA,EACF,CAAC;AACH;AAEA,IAAM,YAAY,YAAY;AAC5B,uBAAI,kBAAkB,wBAAwB;AAC9C,+BAAY,cAAc;AAE1B,cAAY;AACZ,iBAAe;AAEf,sBAAoB;AAAA,IAClB,kBAAkB,CAAC,YAAY;AAC7B,uBAAiB,OAAO;AAAA,IAC1B;AAAA,IACA,kBAAkB,MAAM,WAAW,QAAQ;AAAA,IAC3C,cAAc,CAAC,YAAY,WAAW,OAAO,WAAW,EAAE;AAAA,EAC5D,CAAC;AAED,iBAAe;AACf,QAAM,UAAU;AAClB;AAEA,qBAAI,GAAG,SAAS,SAAS;AAEzB,qBAAI,GAAG,YAAY,MAAM;AACvB,MAAI,+BAAc,cAAc,EAAE,WAAW,GAAG;AAC9C,mBAAe;AAAA,EACjB;AACF,CAAC;AAED,qBAAI,GAAG,qBAAqB,MAAM;AAChC,MAAI,QAAQ,aAAa,UAAU;AACjC,yBAAI,KAAK;AAAA,EACX;AACF,CAAC;AAED,qBAAI,GAAG,eAAe,MAAM;AAC1B,aAAW,KAAK;AAClB,CAAC;","names":["import_node_path","import_electron","path","fs","Database","import_electron","import_electron","import_electron","db","dayjs","db","db","prompt","db","db","import_electron","tray","path"]}